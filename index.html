<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gastos Personales</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, sans-serif;
  background: #f2f2f7;
  margin: 0;
  padding: 16px;
}
h1,h2 { text-align:center; }
.card {
  background:white;
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
}
label {
  font-weight:600;
  margin-top:12px;
  display:block;
}
select, button {
  width:100%;
  padding:12px;
  font-size:16px;
  margin-top:6px;
  border-radius:10px;
  border:1px solid #ccc;
}
.monto { display:flex; gap:10px; }
.monto select { flex:1; }
button {
  background:#007aff;
  color:white;
  border:none;
  margin-top:20px;
}
canvas { width:100%; height:220px; }
.tab {
  display:flex;
  gap:10px;
  margin-bottom:16px;
}
.tab button {
  flex:1;
  background:#e5e5ea;
  color:black;
}
.tab button.active {
  background:#007aff;
  color:white;
}
</style>
</head>

<body>

<h1>üí∏ Gastos</h1>

<div class="tab">
  <button onclick="mostrar('registro')" class="active">Registrar</button>
  <button onclick="mostrar('dashboard')">Dashboard</button>
</div>

<!-- REGISTRO -->
<div id="registro" class="card">

<label>üíµ Monto</label>
<div class="monto">
  <select id="dolares"></select>
  <select id="centavos"></select>
</div>

<label>üìÇ Categor√≠a</label>
<select id="categoria"></select>

<label>üìÅ Subcategor√≠a</label>
<select id="subcategoria"></select>

<label>üë§ Beneficiario</label>
<select id="beneficiario">
  <option>Yo</option>
  <option>Familia</option>
  <option>Otros</option>
</select>

<label>üìç Lugar</label>
<select id="lugar">
  <option>Casa</option><option>Trabajo</option><option>Supermercado</option>
  <option>Farmacia</option><option>Gasolinera</option><option>Restaurante</option>
  <option>Gimnasio</option><option>Online</option><option>Otro</option>
</select>

<label>üí≥ Medio de pago</label>
<select id="pago">
  <option>Efectivo</option><option>Tarjeta</option>
  <option>Peigo</option><option>Online-Gye</option><option>Online-Peigo</option>
</select>

<button onclick="guardar()">Guardar gasto</button>
</div>

<!-- DASHBOARD -->
<div id="dashboard" class="card" style="display:none">
<h2>üìä Resumen del mes</h2>
<canvas id="grafico"></canvas>
<div id="resumen"></div>
</div>

<script>
/* Monto */
for(let i=0;i<=500;i++) dolares.innerHTML+=`<option>${i}</option>`;
for(let i=0;i<100;i++) centavos.innerHTML+=`<option>${i.toString().padStart(2,'0')}</option>`;

/* Categor√≠as y Subcategor√≠as */
const categorias={
"ALIMENTACI√ìN":["Supermercado","Desayuno","Almuerzo","Cena","Snacks","Bebidas","Cumplea√±os"],
"TRANSPORTE":["Gasolina","Taxi","Bus","Mantenimiento","Repuestos","Peajes","Parqueo"],
"SALUD":["Farmacia","Medicamentos","Consulta m√©dica","Ex√°menes","Gimnasio","Hidrataci√≥n","Suplementos"],
"OCIO":["Streaming","Cine","Salidas","Viajes","Compras personales"],
"SOCIAL":["Regalos","Cumplea√±os","Invitaciones","Donaciones"],
"MASCOTAS":["Comida","Veterinario","Higiene","Accesorios"],
"HOGAR":["Compras hogar","Mantenimiento hogar","Agua","Luz"]
};

for(let c in categorias) categoria.innerHTML+=`<option>${c}</option>`;
function cargarSub(){
  subcategoria.innerHTML="";
  categorias[categoria.value].forEach(s=>subcategoria.innerHTML+=`<option>${s}</option>`);
}
categoria.onchange=cargarSub; cargarSub();

/* Tabs */
function mostrar(v){
  registro.style.display=v==="registro"?"block":"none";
  dashboard.style.display=v==="dashboard"?"block":"none";
  document.querySelectorAll(".tab button").forEach(b=>b.classList.remove("active"));
  event.target.classList.add("active");
  if(v==="dashboard") dibujar();
}

/* Guardar */
function guardar(){
  const g={
    fecha:new Date().toISOString(),
    monto:parseFloat(`${dolares.value}.${centavos.value}`),
    categoria:categoria.value,
    subcategoria:subcategoria.value
  };
  const d=JSON.parse(localStorage.getItem("gastos")||"[]");
  d.push(g);
  localStorage.setItem("gastos",JSON.stringify(d));
  alert("‚úÖ Guardado");
}

/* Dashboard */
function dibujar(){
  const data=JSON.parse(localStorage.getItem("gastos")||"[]");
  const tot={};
  data.forEach(g=>tot[g.categoria]=(tot[g.categoria]||0)+g.monto);

  const ctx=grafico.getContext("2d");
  ctx.clearRect(0,0,300,200);
  let x=20;
  for(let c in tot){
    ctx.fillStyle="#007aff";
    ctx.fillRect(x,200-tot[c]/5,30,tot[c]/5);
    ctx.fillText(c,x,195);
    x+=40;
  }

  resumen.innerHTML="";
  for(let c in tot) resumen.innerHTML+=`<p><b>${c}</b>: $${tot[c].toFixed(2)}</p>`;
}
</script>

</body>
</html>
