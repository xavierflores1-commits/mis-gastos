<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Control de Gastos</title>
<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  padding: 20px;
}
h2 {
  margin-top: 30px;
}
form, .dashboard {
  background: white;
  padding: 15px;
  border-radius: 8px;
  margin-bottom: 20px;
}
label {
  display: block;
  margin-top: 10px;
  font-weight: bold;
}
input, select, textarea, button {
  width: 100%;
  padding: 6px;
  margin-top: 4px;
}
textarea {
  resize: vertical;
}
button {
  margin-top: 15px;
  background: #2e86de;
  color: white;
  border: none;
  cursor: pointer;
}
button:hover {
  background: #1b4f72;
}
.dashboard div {
  margin: 6px 0;
  font-size: 16px;
}
</style>
</head>

<body>

<h2>ðŸ“Œ Registro de Gastos</h2>

<form id="formGasto">

<label>Fecha</label>
<input type="date" id="fecha" required>

<label>CategorÃ­a</label>
<select id="categoria" required></select>

<label>SubcategorÃ­a</label>
<select id="subcategoria"></select>

<label>Beneficiario</label>
<input type="text" id="beneficiario">

<label>Lugar</label>
<input type="text" id="lugar">

<label>Monto</label>
<input type="number" id="monto" step="0.01" required>

<label>Medio de pago</label>
<select id="medioPago">
  <option>Efectivo</option>
  <option>DÃ©bito</option>
  <option>CrÃ©dito</option>
  <option>Transferencia</option>
</select>

<label>Detalle</label>
<textarea id="detalle"></textarea>

<label>ObservaciÃ³n</label>
<textarea id="observacion"></textarea>

<button type="submit">Guardar gasto</button>
</form>

<h2>ðŸ“Š Dashboard</h2>
<div class="dashboard" id="dashboard"></div>

<script>
const categorias = {
  "ALIMENTACION": ["SOCIAL","SUPERMERCADO","RESTAURANTE","GIMNASIO","CAFE"],
  "TRANSPORTE": ["BUS","UBER","TAXI","TRICIMOTO"],
  "SALUD": ["CONSULTAS","EXAMENES","MEDICAMENTOS","SUPLEMENTOS","ASEO PERSONAL","SKINCARE"],
  "OCIO": ["CINE","VIAJES","SUBSCRIPCIONES"],
  "SOCIAL": ["HOTEL","AIRBNB","PAGOS"],
  "MASCOTAS": ["COMIDA","VETERINARIO","MEDICINA"],
  "AUTO": ["REPUESTOS","ACEITE","LAVADA","LLANTAS","MECANICO","FILTROS"],
  "OTROS": []
};

const categoriaSelect = document.getElementById("categoria");
const subcategoriaSelect = document.getElementById("subcategoria");
const dashboard = document.getElementById("dashboard");

function cargarCategorias() {
  categoriaSelect.innerHTML = "";
  Object.keys(categorias).forEach(cat => {
    const opt = document.createElement("option");
    opt.value = cat;
    opt.textContent = cat;
    categoriaSelect.appendChild(opt);
  });
  actualizarSubcategorias();
}

function actualizarSubcategorias() {
  const cat = categoriaSelect.value;
  subcategoriaSelect.innerHTML = "";
  categorias[cat].forEach(sub => {
    const opt = document.createElement("option");
    opt.value = sub;
    opt.textContent = sub;
    subcategoriaSelect.appendChild(opt);
  });
}

categoriaSelect.addEventListener("change", actualizarSubcategorias);

document.getElementById("formGasto").addEventListener("submit", e => {
  e.preventDefault();

  const gasto = {
    fecha: fecha.value,
    categoria: categoriaSelect.value,
    subcategoria: subcategoriaSelect.value,
    beneficiario: beneficiario.value,
    lugar: lugar.value,
    monto: parseFloat(monto.value),
    medioPago: medioPago.value,
    detalle: detalle.value,
    observacion: observacion.value
  };

  const gastos = JSON.parse(localStorage.getItem("gastos") || "[]");
  gastos.push(gasto);
  localStorage.setItem("gastos", JSON.stringify(gastos));

  e.target.reset();
  cargarCategorias();
  actualizarDashboard();
});

function actualizarDashboard() {
  const gastos = JSON.parse(localStorage.getItem("gastos") || "[]");
  if (gastos.length === 0) {
    dashboard.innerHTML = "<em>No hay gastos registrados</em>";
    return;
  }

  let total = 0;
  gastos.forEach(g => total += g.monto);

  dashboard.innerHTML = `
    <div><strong>Total de gastos:</strong> $${total.toFixed(2)}</div>
    <div><strong>Registros:</strong> ${gastos.length}</div>
  `;
}

cargarCategorias();
actualizarDashboard();
</script>

</body>
</html>
